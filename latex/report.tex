%%%%%%%% DATA LITERACY 2025 LATEX PROJECT TEMPLATE FILE %%%%%%%%%%%%%%%%%
%%% Based on the 2025 ICML template, available at https://icml.cc/Conferences/2025/AuthorInstructions %%%

\documentclass{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables
\usepackage{comment}
\usepackage{tabularx}
\usepackage{enumitem} % fix distance in itemize


\usepackage{tikz}
% Corporate Design of the University of Tübingen
% Primary Colors
\definecolor{TUred}{RGB}{165,30,55}
\definecolor{TUgold}{RGB}{180,160,105}
\definecolor{TUdark}{RGB}{50,65,75}
\definecolor{TUgray}{RGB}{175,179,183}

% Secondary Colors
\definecolor{TUdarkblue}{RGB}{65,90,140}
\definecolor{TUblue}{RGB}{0,105,170}
\definecolor{TUlightblue}{RGB}{80,170,200}
\definecolor{TUlightgreen}{RGB}{130,185,160}
\definecolor{TUgreen}{RGB}{125,165,75}
\definecolor{TUdarkgreen}{RGB}{50,110,30}
\definecolor{TUocre}{RGB}{200,80,60}
\definecolor{TUviolet}{RGB}{175,110,150}
\definecolor{TUmauve}{RGB}{180,160,150}
\definecolor{TUbeige}{RGB}{215,180,105}
\definecolor{TUorange}{RGB}{210,150,0}
\definecolor{TUbrown}{RGB}{145,105,70}


% tighten figure spacing
\setlength{\floatsep}{6pt}
\setlength{\textfloatsep}{8pt}
\setlength{\intextsep}{6pt}

% tighten caption spacing
\setlength{\abovecaptionskip}{4pt}
\setlength{\belowcaptionskip}{0pt}


% hyperref makes hyperlinks in the resulting PDF.
% If your build breaks (sometimes temporarily if a hyperlink spans a page)
% please comment out the following usepackage line and replace
% \usepackage{icml2023} with \usepackage[nohyperref]{icml2023} above.
\usepackage{hyperref}


% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}


\usepackage[accepted]{icml2025}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}

%\usepackage[textsize=tiny]{todonotes}
\usepackage[disable]{todonotes}


% The \icmltitle you define below is probably too long as a header.
% Therefore, a short form for the running title is supplied here:
\icmltitlerunning{Project Report Template for Data Literacy 2025}

\begin{document}

\twocolumn[
\icmltitle{Usage Patterns of Bicycle Counting Stations in Heidelberg \\ and the Influence of External Factors}

\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Julian Jurcevic}{equal,first}
\icmlauthor{Martin Eichler}{equal,second}
\icmlauthor{Simon Rappenecker}{equal,third}
\icmlauthor{Tarik Eker}{equal,fourth}
\end{icmlauthorlist}

% fill in your matrikelnummer, email address, degree, for each group member
\icmlaffiliation{first}{Matrikelnummer 7167089, MSc Computer Science}
\icmlaffiliation{second}{Matrikelnummer 6009076, MSc Computer Science}
\icmlaffiliation{third}{Matrikelnummer 6324777, MSc Machine Learning}
\icmlaffiliation{fourth}{Matrikelnummer 5668988, MSc Computer Science}

% put your email addresses here. You can use initials to save space, 
% DO USE YOUR UNIVERSITY EMAIL ADDRESS!
\icmlcorrespondingauthor{JJ}{julian-steffan.jurcevic@student.uni-tuebingen.de} 
\icmlcorrespondingauthor{ME}{martin.eichler@student.uni-tuebingen.de}
\icmlcorrespondingauthor{SR}{simon.rappenecker@student.uni-tuebingen.de}
\icmlcorrespondingauthor{TE}{tarik.eker@student.uni-tuebingen.de}

% You may provide any keywords that you
% find helpful for describing your paper; these ar^^e used to populate
% the "keywords" metadata in the PDF but will not be shown in the document
\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in
]

% \begin{itemize}
% \item Describe topic
% \item Data source (just heidelberg) and external Factors
% \item sentence in one method
% \item Results briefly
% \end{itemize}


\begin{abstract}
As cycling becomes key in sustainable urban mobility, understanding spatiotemporal traffic patterns is essential for infrastructure planning. 
While previous studies have classified bicycle traffic, they often rely on predefined, rule-based approaches that may fail to capture hybrid usage behaviors. 
Addressing this limitation, we present a data-driven approach to classify urban bicycle traffic using hourly data from counting stations in Heidelberg, Germany. 
We derive features to quantify the shape of traffic patterns across various timescales. 
Subsequent $k$-means distinguishes distinct usage patterns: \emph{utilitarian}, \emph{recreational}, and \emph{mixed}.
Finally, we investigate the influence of external factors, such as weather and public holidays, which varies significantly across different usage types. \footnote{Source files are publicly available in the \href{https://github.com/julilili42/datalit}{\textcolor{TUred}{project repository}}.}


\end{abstract}


%\begin{itemize}
%    \item Short introduction, but more motivational, bicycle traffic more important over the years...
%    \item Name what is interesting and why it matters
%    \item Shortly introduce the data, and the main method
%\end{itemize}

\section{Introduction}\label{sec:intro}

Sustainable urban traffic relies heavily on the expansion of cycling, which is explicitly promoted by both the state of Baden-Württemberg and the city of Heidelberg as part of their long-term mobility strategies \cite{bw2016_radstrategie, heidelberg_radstrategie_2030}. 
To translate these strategies into infrastructure, planners require a good understanding of traffic behavior. Specifically, they need to know not just how many people are cycling, but when and why.


Trip purposes are typically inferred from spatiotemporal traffic patterns. 
While previous studies have successfully used hourly and daily counts to distinguish utilitarian from recreational traffic, 
they often rely on rule-based approaches \cite{american_bike_patterns}. 
These methods, however, struggle to capture hybrid usage patterns common in urban environments.


Furthermore, cycling demand is highly sensitive to external factors.
Precipitation, temperature, and public holidays can influence traffic patterns \cite{liu2015_weather_mode_choice_sweden, rudloff2014_weather_transport_vienna, cools2007_holidays_traffic}. 
Since commuters are more weather-resilient than leisure riders, these effects vary by usage type \cite{heinen2011_day_to_day_bicycle}. 
Therefore, we aim to understand how these factors influence the demand profiles of different usage types in the city of Heidelberg, Germany.

To overcome the limitations of rule-based classification, we present a flexible, data-driven approach.
Using hourly counting data from 15 stations in Heidelberg (Figure~\ref{fig:station_map}), we identify distinct usage patterns and analyze their sensitivity to external factors.

\section{Data}\label{sec:data}
The analysis is based on bicycle traffic counts complemented by weather and public holiday data.
In the following, we describe the data sources, preprocessing steps, and quality checks.

\subsection{Bicycle Counting Data}
The bicycle counting stations in Heidelberg are densely and centrally distributed across the urban area. For our analysis, hourly bicycle counts from 15 permanent monitoring stations installed between May 2014 and January 2020 were used.
\todo{Data from interval 2016-01-01 until 2025-01-01 was used for prob. clustering}
The stations provide hourly bicycle counts using inductive loop sensors \cite{ecocounter_zelt}.
The data are publicly available via the MobiData BW open data platform \cite{mobidatabw_api}.

Data quality was assessed by marking days with fewer than 12 hourly observations as missing and flagging zero-count days at high-traffic stations (median $>$ 500 cyclists/day) as sensor failures.
Table~\ref{tab:station_quality} summarizes data availability and basic traffic statistics for all 15 stations (S1–S15), reporting mean daily counts and day-to-day variability (Std).

\begin{table}[t]
\centering
\caption{Data quality and traffic statistics for Heidelberg bicycle counting stations.}
\label{tab:station_quality}
\resizebox{\columnwidth}{!}{%
\begin{tabular}{@{}rlrrrr@{}}
\toprule
\textbf{ID} & \textbf{Station} & \textbf{Mean} & \textbf{Std} &  \textbf{Avail.} \\
 & & \small{[bikes/d]} &  & \small{[\%]} \\
\midrule
S1  & Plöck             & 4180 & 1832 &   91.5 \\
S2  & Kurfürstenanlage  & 1257 &  630 &   91.8 \\
S3  & Ernst-Walz-Brücke    & 6179 & 3344 & 100.0 \\
S4  & Gaisbergstraße    & 4239 & 1651 &   94.7 \\
S5 & Schlierbacher Landstr.&  786 &  389 &   60.2 \\
S6 & Ziegelhäuser Landstr. &  872 &  389 &   58.3 \\
S7  & Rohrbacher Str.   & 2426 & 1251 &   95.7 \\
S8  & Theodor-Heuss-Br. & 7902 & 2865 & 100.0 \\
S9 & Mannheimer Str.   & 1964 &  845 &   83.2 \\
S10  & Ernst-Walz-Brücke alt& 3240 & 1517 &   99.9 \\
S11 & Hardtstraße       & 1690 &  640 &   79.4 \\
S12  & Berliner Str.     &  705 &  245 &   92.3 \\
S13 & Bahnstadtprom.    & 2759 & 1203 &   63.7 \\
S14  & Eppelheimer Str.  &  909 &  452 &   95.6 \\
S15 & Liebermannstr.    & 4101 & 1456 &   71.9 \\
\bottomrule
\end{tabular}%
}
\end{table}

\subsection{Weather Data}
Hourly weather data were obtained from the Open-Meteo API \cite{open_meteo_api}.
As all stations lie within a single grid cell, a city-wide hourly weather time series was used for all stations.
Locally recorded weather data from the counting stations were excluded due to inconsistencies with official weather data.



\subsection{Holiday Data}
Public holidays and school vacation periods for Baden-Württemberg were obtained from the Mehr Schulferien API \cite{mehr_schulferien}.
\todo{Data quality: Add measures that had to be taken to clean up dataset}

\section{Method}\label{sec:methods}
Previous works often rely on predefined rules to categorize bicycle traffic \citep{american_bike_patterns}. However, such an approach may fail to capture hybrid usage patterns.
We propose a more data-driven, implicit approach. By extracting features that quantify the 'shape' of daily, weekly, and seasonal profiles,
we map each station into a multi-dimensional feature space. This allows us to use unsupervised k-means clustering \citep{kmeans} to discover different usage types. 

In a subsequent step, cluster semantics are assigned post hoc, resulting in the following usage types:
\begin{itemize}[noitemsep, topsep=1pt]
    \item \emph{Utilitarian (Util)}: Traffic showing strong commuting patterns, with two distinct peaks in traffic volume during the morning and afternoon hours.
    \item \emph{Recreational (Rec)}: Traffic dominated by leisure activities. These locations exhibit a single peak in traffic volume around midday or early afternoon.
    \item \emph{Mixed (Mix)}: Dual-purpose locations exhibiting both utilitarian and recreational characteristics.
\end{itemize}

% Why k = 3?
The number of clusters was fixed to $k=3$ to reflect the conceptual distinction between utilitarian, recreational, and mixed usage.
Elbow and silhouette analyses indicate a dominant separation between two extreme patterns, while $k=3$ introduces a stable intermediate cluster with only a minor loss in geometric separation.

% k-Means Features
We represent station usage using three interpretable features capturing intra-day patterns, weekday–weekend differences, and seasonal variability. 
Features are derived from station-level normalised hourly, daily, and monthly traffic indices $(I_h, I_w, I_m)$ \cite{american_bike_patterns}, and are conceptually aligned with the indicators used therein.
The resulting feature space is low-dimensional, volume-invariant, and preserves temporal structure.
Feature relevance was assessed using correlation analysis, PCA, and permutation-based importance measures.



% DPI
\paragraph{Double Peak Index (DPI)}
Weekday hourly profiles at utilitarian stations often exhibit pronounced commuting peaks.
The Double Peak Index (DPI) quantifies this pattern by comparing the dominant morning (5–10 h) and late-day (14–20 h) peaks to the average midday level (8–14 h).

Let $p_m$ and $p_e$ denote the magnitudes of the morning and late-day peaks at hours $h_m$ and $h_e$, and let $m$ be the average midday level.
The DPI is defined as
\begin{align*}
\mathrm{DPI} = \max\!\left( S \cdot Y \cdot D,\, 0 \right),
\end{align*}
where
\begin{align*}
S &= \tfrac{(p_m - m) + (p_e - m)}{2}, \\
Y &= 1 - \tfrac{|p_m - p_e|}{\max(p_m, p_e)}, \\
D &= \min\!\left(\tfrac{|h_e - h_m|}{10},\, 1\right)
\end{align*}
capture peak strength, symmetry, and temporal separation, respectively.


% WSD
\paragraph{Weekend Shape Difference (WSD)}
Differences between weekday and weekend hourly profiles provide an additional discriminator between usage types.
Let $\mathbf{p}^{wd}$ and $\mathbf{p}^{we}$ denote the weekday and weekend hourly profiles, normalised to unit sum.
The Weekend Shape Difference (WSD) is defined as
\begin{align*}
\mathrm{WSD} =
\left\lVert
\mathbf{p}^{wd}
-
\mathbf{p}^{we}
\right\rVert_2 .
\end{align*}

% SDI
\paragraph{Seasonal Drop Index (SDI)}
Seasonality provides an additional discriminator between recreational and utilitarian stations.
We quantify long-term variability using the Seasonal Drop Index (SDI), defined from the monthly index $I_m$.
Robust upper and lower quantiles are given by
\begin{align*}
q_{90} &= \mathrm{quantile}_{0.9}(I_m), &
q_{10} &= \mathrm{quantile}_{0.1}(I_m),
\end{align*}
and the SDI is defined as
\begin{align*}
\mathrm{SDI} = \frac{q_{90} - q_{10}}{q_{90}} .
\end{align*}


\subsection*{Temporal Clustering}\label{sec:temporal_clustering}
To account for temporal variability in bicycle traffic, $k$-means clustering is performed on sliding two-year windows with monthly shifts. Feature vectors are recomputed separately for each window.

For each station $s$ and usage type $u$, the empirical cluster membership probability is defined as
\[
P(u \mid s) = \frac{1}{N_s} \sum_{i=1}^{N_s} \mathbb{I}\bigl( c_i(s) = u \bigr),
\]
where $c_i(s)$ denotes the cluster assignment in the $i$-th run and $N_s$ the number of valid runs.

Since $k$-means produces unlabeled partitions, cluster semantics are assigned post hoc by ordering clusters using a centroid-level \emph{utilitarian score}
\[
\text{DPI} + \text{WSD} - \text{SDI}.
\]
Prior work characterises utilitarian stations by pronounced weekday commuting peaks, strong weekday–weekend contrast, and comparatively weak seasonality \cite{american_bike_patterns}.
Clusters with higher scores are labeled \emph{utilitarian}, intermediate scores as \emph{mixed}, and lower scores as \emph{recreational}.


\subsection*{Weather and Event Class Definitions}
For the event-based analysis, days were grouped into three classes based on temperature and precipitation using data-driven quantile thresholds (Table~\ref{tab:weather_classes}).
Here, quantiles are computed over the empirical city-wide distribution of daily weather observations and serve solely to define comparable event classes.

Low-condition days ($L$) serve as baseline, and relative changes in mean daily bicycle counts for class $X \in \{M,H\}$ are computed as
\[
\Delta_X = \frac{\bar{C}_X - \bar{C}_L}{\bar{C}_L} \times 100.
\]


\begin{table}[t]
\centering
\caption{Weather class definitions for the event-based analysis.}
\label{tab:weather_classes}
\small
\begin{tabular}{c cc}
\toprule
Class &
$T_{\max}$ [$^\circ$C] &
$P_{\text{day}}$ [mm] \\
\midrule
$L$ & $< q_{33}$ & $= 0$ \\
$M$ & $[q_{33},\,q_{66})$ & $(0,\,q_{80}]$ \\
$H$ & $\ge q_{66}$ & $> q_{80}$ \\
\bottomrule
\end{tabular}

\vspace{3pt}
{\footnotesize
Empirical thresholds: $q_{33}=10.7^\circ$C, $q_{66}=19.8^\circ$C (temperature),
$q_{80}=7.1$ mm (precipitation).
}
\end{table}




\section{Results}\label{sec:results}
This section presents the results of the proposed clustering approach and analyzes the spatial distribution of station usage types as well as their sensitivity to external factors.
\subsection{Station Usage Types and Spatial Structure}\label{sec:results_clustering}
Figure~\ref{fig:clustering_prob} presents the probabilistic usage type assignments. 
Cluster labels correspond to the usage types defined in Section~\ref{sec:methods} and are assigned based on the centroid-level utilitarian score.
Some stations show near-deterministic assignments with low entropy (e.g., S1–S3), while others exhibit more balanced probabilities, indicating temporally variable usage.

\begin{figure}[t]
    \centering
    \caption{Probabilistic usage type assignments of bicycle counting stations.}
    \includegraphics[width=\columnwidth]{img/clustering_prob.png}
    \label{fig:clustering_prob}
\end{figure}

In the following analysis, each station is assigned its dominant usage type, defined as the class with the highest assignment probability. 
Figure~\ref{fig:station_map} visualizes the spatial distribution of stations by dominant usage type.

\begin{figure}[t]
    \centering
    \caption{
    Spatial distribution of bicycle counting stations in Heidelberg. 
    Marker color and shape indicate the dominant usage type. Marker size reflects the assignment probability of the dominant class.}
    \includegraphics[width=\columnwidth]{img/station_usage_map.png}
    \label{fig:station_map}
\end{figure}

Utilitarian stations are primarily located along major traffic corridors and key commuting links.
For example, Ernst-Walz-Bridge (S10) serves as Heidelberg’s central river crossing, while Gaisbergstraße (S4) is a designated bicycle priority corridor intended to relieve bicycle traffic from the parallel Rohrbachstraße (S7) \cite{adfc_heidelberg_fahrradstrassen}.


Mixed stations predominantly occur in transitional urban zones.
Stations such as S5, S6, and S9 connect several residential districts to the city center and combine utilitarian demand with recreational usage due to their location along the Neckar river.
Similarly, S13 is located along a corridor linking Kirchheim to the city center and bordering extensive green areas.


Recreational stations are mainly located in areas with limited commuting relevance and high leisure appeal. For example, Plöck (S1) lies in Heidelberg’s historic old town near the Universitätsbibliothek Heidelberg and other university buildings. 
This results in predominantly tourist- and student-oriented traffic with reduced utilitarian demand.


\subsection{Impact of External Factors on Usage Types}\label{sec:results_external}
We first examine the effects of weather conditions, followed by the impact of public holidays on station usage.

\begin{table}[t]
\centering
\caption{Effect of temperature on station usage across usage types.}
\label{tab:temperature_effect}
\small
\begin{tabularx}{\linewidth}{l*{6}{c}}
\toprule
 & \multicolumn{3}{c}{\textbf{Weekdays}} 
 & \multicolumn{3}{c}{\textbf{Weekends}} \\
\textbf{Type}
 & $L$ & $\Delta_M$ & $\Delta_H$
 & $L$ & $\Delta_M$ & $\Delta_H$ \\
\midrule
Mix
& 1383 & 21\% & 70\%
& 887  & 27\% & 116\% \\

Rec
& 1009 & 7\%  & 36\%
& 754  & 16\% & 64\% \\

Util
& 3424 & 11\% & 39\%
& 2368 & 17\% & 61\% \\
\bottomrule
\end{tabularx}
\end{table}


Bicycle traffic increases with rising temperatures across all usage types (Table~\ref{tab:temperature_effect}).
Mixed stations exhibit the strongest temperature sensitivity, particularly on weekends, while utilitarian and recreational stations show more moderate responses.

\begin{table}[t]
\centering
\caption{Effect of precipitation on station usage across usage types.}
\label{tab:precipitation_effect}
\small
\begin{tabularx}{\linewidth}{l*{6}{c}}
\toprule
 & \multicolumn{3}{c}{\textbf{Weekdays}} 
 & \multicolumn{3}{c}{\textbf{Weekends}} \\
\textbf{Type}
 & $L$ & $\Delta_M$ & $\Delta_H$
 & $L$ & $\Delta_M$ & $\Delta_H$ \\
\midrule
Mix
& 2100 & $-17$\% & $-37$\%
& 1587 & $-19$\% & $-46$\% \\

Rec
& 1510 & $-9$\%  & $-22$\%
& 1275 & $-12$\% & $-29$\% \\

Util
& 4810 & $-8$\%  & $-23$\%
& 3823 & $-13$\% & $-29$\% \\
\bottomrule
\end{tabularx}
\end{table}


Precipitation consistently reduces bicycle traffic across all usage types (Table~\ref{tab:precipitation_effect}).
The strongest declines occur at mixed stations, especially on weekends, whereas utilitarian and recreational stations are less affected.

Overall, weather sensitivity differs systematically by usage type and reflects underlying trip purposes.


\begin{table}[t]
\centering
\caption{Effect of public holidays on station usage by usage type.}
\label{tab:holiday_effect}
\small
\newcolumntype{C}{>{\centering\arraybackslash}X}
\begin{tabularx}{\linewidth}{l C C C}
\toprule
\textbf{Type}
& No holiday
& Holiday
& $\Delta$ \\
\midrule
Mix        & 1648 &  953 & $-28.6\%$ \\
Rec & 1260 &  728 & $-42.2\%$ \\
Util  & 3238 & 2043 & $-42.8\%$ \\
\bottomrule
\end{tabularx}
\end{table}

Public holidays substantially reduce bicycle traffic across all usage types (Table~\ref{tab:holiday_effect}).
Reductions are strongest at recreational and utilitarian stations, while mixed stations are less affected.
Beyond volume effects, holidays also weaken weekday commuting peaks and shift usage toward weekend-like profiles (Figure~\ref{fig:holiday_shape}).

\begin{figure}[t]
    \centering
    \caption{Holiday-induced structural changes in station usage.}
    \includegraphics[width=\columnwidth]{img/holiday_impact.png}
    \label{fig:holiday_shape}
\end{figure}

Together, these results highlight that external factors affect not only traffic volume but also temporal usage structure in a type-specific manner.


%\begin{itemize}
%    \item describe temporal shift, describe why this is expected and why, PLOT: city,
%    \item describe holidays impact, describe behaviour (similar as weekend) PLOT: show shift
%    \item include also plot of different public holidays (my own one), this is just to have a funny fact (Vater Tag) PLOT: funny plot, na werden zu viele plots
%    \item describe weather impact, obvious PLOT: weather
%\end{itemize}


\section{Conclusion}\label{sec:conclusion}
This analysis identified distinct bicycle usage patterns across stations in Heidelberg and showed that their spatial distribution and sensitivity to external factors differ systematically.
Utilitarian, recreational, and mixed stations respond differently to weather and public holidays, reflecting underlying trip purposes.
Overall, the results highlight that urban bicycle demand cannot be captured by traffic volume alone, but requires consideration of temporal usage patterns and contextual influences.


\section*{Contribution Statement}
Simon Rappenecker and Martin Eichler were responsible for the acquisition and preprocessing of the bicycle counting and weather datasets. Julian Jurcevic and Tarik Eker developed the feature engineering framework. All authors contributed equally to the interpretation of the results and the final drafting of this report.
%\begin{itemize}
%    \item summarize
%    \item limitations
%    \item problems
%    \item statements that can be made
%\end{itemize}

\clearpage

% Footnote
%\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution
\printAffiliationsAndNotice{\icmlEqualContribution} % otherwise use the standard text.



\bibliography{bibliography}
\bibliographystyle{icml2025}

\end{document}

% This document was modified from the files available at https://icml.cc/Conferences/2025/AuthorInstructions
% the full copyright notice is available within the file icml2025.sty