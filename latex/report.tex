%%%%%%%% DATA LITERACY 2025 LATEX PROJECT TEMPLATE FILE %%%%%%%%%%%%%%%%%
%%% Based on the 2025 ICML template, available at https://icml.cc/Conferences/2025/AuthorInstructions %%%

\documentclass{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables
\usepackage{comment}
\usepackage{tabularx}
\usepackage{enumitem} % fix distance in itemize


\usepackage{tikz}
% Corporate Design of the University of Tübingen
% Primary Colors
\definecolor{TUred}{RGB}{165,30,55}
\definecolor{TUgold}{RGB}{180,160,105}
\definecolor{TUdark}{RGB}{50,65,75}
\definecolor{TUgray}{RGB}{175,179,183}

% Secondary Colors
\definecolor{TUdarkblue}{RGB}{65,90,140}
\definecolor{TUblue}{RGB}{0,105,170}
\definecolor{TUlightblue}{RGB}{80,170,200}
\definecolor{TUlightgreen}{RGB}{130,185,160}
\definecolor{TUgreen}{RGB}{125,165,75}
\definecolor{TUdarkgreen}{RGB}{50,110,30}
\definecolor{TUocre}{RGB}{200,80,60}
\definecolor{TUviolet}{RGB}{175,110,150}
\definecolor{TUmauve}{RGB}{180,160,150}
\definecolor{TUbeige}{RGB}{215,180,105}
\definecolor{TUorange}{RGB}{210,150,0}
\definecolor{TUbrown}{RGB}{145,105,70}

% hyperref makes hyperlinks in the resulting PDF.
% If your build breaks (sometimes temporarily if a hyperlink spans a page)
% please comment out the following usepackage line and replace
% \usepackage{icml2023} with \usepackage[nohyperref]{icml2023} above.
\usepackage{hyperref}


% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}


\usepackage[accepted]{icml2025}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}

\usepackage[textsize=tiny]{todonotes}


% The \icmltitle you define below is probably too long as a header.
% Therefore, a short form for the running title is supplied here:
\icmltitlerunning{Project Report Template for Data Literacy 2025}

\begin{document}

\twocolumn[
\icmltitle{Usage Patterns of Bicycle Counting Stations in Heidelberg \\ and the Influence of External Factors}

\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Julian Jurcevic}{equal,first}
\icmlauthor{Martin Eichler}{equal,second}
\icmlauthor{Simon Rappenecker}{equal,third}
\icmlauthor{Tarik Eker}{equal,fourth}
\end{icmlauthorlist}

% fill in your matrikelnummer, email address, degree, for each group member
\icmlaffiliation{first}{Matrikelnummer 7167089, MSc Computer Science}
\icmlaffiliation{second}{Matrikelnummer 6009076, MSc Computer Science}
\icmlaffiliation{third}{Matrikelnummer 6324777, MSc Machine Learning}
\icmlaffiliation{fourth}{Matrikelnummer 5668988, MSc Computer Science}

% put your email addresses here. You can use initials to save space, 
% DO USE YOUR UNIVERSITY EMAIL ADDRESS!
\icmlcorrespondingauthor{JJ}{julian-steffan.jurcevic@student.uni-tuebingen.de} 
\icmlcorrespondingauthor{ME}{martin.eichler@student.uni-tuebingen.de}
\icmlcorrespondingauthor{SR}{simon.rappenecker@student.uni-tuebingen.de}
\icmlcorrespondingauthor{TE}{tarik.eker@student.uni-tuebingen.de}

% You may provide any keywords that you
% find helpful for describing your paper; these ar^^e used to populate
% the "keywords" metadata in the PDF but will not be shown in the document
\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in
]

% \begin{itemize}
% \item Describe topic
% \item Data source (just heidelberg) and external Factors
% \item sentence in one method
% \item Results briefly
% \end{itemize}


\begin{abstract}
As cycling becomes key in sustainable urban mobility, understanding spatiotemporal traffic patterns is essential for infrastructure planning. 
While previous studies have classified bicycle traffic, they often rely on predefined, rule-based approaches that may fail to capture hybrid usage behaviors. 
Addressing this limitation, we present a data-driven approach to classify urban bicycle traffic using hourly data from counting stations in Heidelberg, Germany. 
We derive special features to quantify the shape of traffic patterns across various timescales. 
Subsequent $k$-means distinguishes distinct usage patterns: \emph{utilitarian}, \emph{recreational}, and \emph{mixed}.
Finally, we investigate the influence of external factors, such as weather and public holidays, which varies significantly across different station types.
\end{abstract}


%\begin{itemize}
%    \item Short introduction, but more motivational, bicycle traffic more important over the years...
%    \item Name what is interesting and why it matters
%    \item Shortly introduce the data, and the main method
%\end{itemize}

\section{Introduction}\label{sec:intro}
Sustainable urban traffic relies heavily on the expansion of cycling. The state of Baden-Württemberg recognizes this, explicitly promoting cycling as a key component of its long-term strategy \cite{bw2016_radstrategie}. 
To translate these strategies into infrastructure, planners require a good understanding of traffic behavior. Specifically, they need to know not just how many people are cycling, but when and why. \\ \\
%
Trip purposes are typically inferred from spatiotemporal traffic patterns. 
While previous studies have successfully used hourly and daily counts to distinguish utilitarian from recreational traffic, 
they often rely on rule-based approaches \cite{american_bike_patterns}. 
These methods, however, struggle to capture hybrid usage patterns common in urban environments.  \\ \\
%
Furthermore, cycling demand is highly sensitive to external factors.
Precipitation, temperature, and public holidays can influence traffic patterns \cite{liu2015_weather_mode_choice_sweden, rudloff2014_weather_transport_vienna, cools2007_holidays_traffic}. 
Since commuters are more weather-resilient than leisure riders, these effects vary by station type \cite{heinen2011_day_to_day_bicycle}. 
Therefore, we aim to understand how these factors influence the demand profiles of different station types in the city of Heidelberg, Germany.  \\ \\
%
To overcome the limitations of rule-based classification, we present a flexible, data-driven approach. 
Using hourly counting data from 15 stations in Heidelberg \todo{Link Map}, we first derive features to quantify traffic shapes across daily, weekly, and seasonal timescales.
We then apply $k$-means clustering to identify different usage patterns (\emph{utilitarian}, \emph{recreational}, and \emph{mixed})
and analyze their sensitivity to weather and public holidays.

\section{Data}\label{sec:data}
The analysis is based on bicycle traffic counts complemented by weather and public holiday data.
In the following, we describe the data sources, preprocessing steps, and quality checks.

\subsection{Bicycle Counting Data}
The bicycle counting stations in Heidelberg are densely and centrally distributed across the urban area. For our analysis, hourly bicycle counts from 15 permanent monitoring stations installed between May 2014 and January 2020 were used.
The stations record counts at an hourly resolution using Eco-Counter systems equipped with ZELT inductive loops \cite{ecocounter_zelt}.
These inductive loops are embedded in the pavement and detect cyclists based on characteristic electromagnetic signatures.
Most stations are capable of recording directional flows (inbound and outbound).

The counting data is publicly available via the MobiData BW open data platform \cite{mobidatabw_api}.


Data quality was assessed by treating days with fewer than 12 hourly observations as missing and by flagging zero-count days at high-traffic stations (median $>$ 500 cyclists/day) as probable sensor failures. 
Table~\ref{tab:station_quality} reports data quality and traffic statistics for all 15 stations. Stations are identified by short IDs (S1–S15) and referenced consistently throughout the paper. The standard deviation (Std) captures day-to-day variability, while the 95\% confidence interval margin (CI) quantifies the uncertainty of the estimated daily mean.


\begin{table}[ht]
\centering
\caption{Data quality and traffic statistics for Heidelberg bicycle counting stations, ranked by data availability.}
\label{tab:station_quality}
\resizebox{\columnwidth}{!}{%
\begin{tabular}{@{}rlrrrr@{}}
\toprule
\textbf{ID} & \textbf{Station} & \textbf{Mean} & \textbf{Std} & \textbf{CI} & \textbf{Avail.} \\
 & & \small{[bikes/d]} & & \small{[$\pm$]} & \small{[\%]} \\
\midrule
S1  & Plöck             & 4180 & 1832 &  62 &  91.5 \\
S2  & Kurfürstenanlage  & 1257 &  630 &  26 &  91.8 \\
S3  & Ernst-Walz-Br.    & 6179 & 3344 & 101 & 100.0 \\
S4  & Gaisbergstraße    & 4239 & 1651 &  57 &  94.7 \\
S5 & Schlierb. Landstr.&  786 &  389 &  20 &  60.2 \\
S6 & Ziegelh. Landstr. &  872 &  389 &  20 &  58.3 \\
S7  & Rohrbacher Str.   & 2426 & 1251 &  48 &  95.7 \\
S8  & Theodor-Heuss-Br. & 7902 & 2865 & 108 & 100.0 \\
S9 & Mannheimer Str.   & 1964 &  845 &  28 &  83.2 \\
S10  & Ernst-Walz-Br. alt& 3240 & 1517 &  75 &  99.9 \\
S11 & Hardtstraße       & 1690 &  640 &  30 &  79.4 \\
S12  & Berliner Str.     &  705 &  245 &  11 &  92.3 \\
S13 & Bahnstadtprom.    & 2759 & 1203 &  67 &  63.7 \\
S14  & Eppelheimer Str.  &  909 &  452 &  20 &  95.6 \\
S15 & Liebermannstr.    & 4101 & 1456 &  57 &  71.9 \\
\bottomrule
\end{tabular}%
}
\end{table}

\subsection{Weather Data}
Weather data were used as external factors influencing bicycle counts.

Hourly weather data were obtained from the Open-Meteo API \cite{open_meteo_api}.
The data cover the period from 2013 to 2024 \todo{2013 is not used, right?} and provides hourly weather information based on numerical weather models from national meteorological services.


As nearly all bicycle counting stations in Heidelberg lie within the same Open-Meteo grid cell, a single city-wide hourly weather time series was used for all stations.

Locally recorded meteorological data from the counting stations were excluded due to inconsistencies identified in comparison with official weather data.

\subsection{Holiday Data}
Public holidays and school vacation periods were included to model calendar effects on bicycle traffic.
Holiday data for Baden-Württemberg were obtained from the Mehr Schulferien API \cite{mehr_schulferien_api}, providing start and end dates for public holidays and school vacations.
\todo{Data quality: Add measures that had to be taken to clean up dataset}

\section{Method}\label{sec:methods}
Previous works often rely on predefined rules to categorize bicycle traffic \citep{american_bike_patterns}. However, such an approach may fail to capture hybrid usage patterns.
We propose a more data-driven, implicit approach. By extracting features that quantify the 'shape' of daily, weekly, and seasonal profiles,
we map each station into a multi-dimensional feature space. This allows us to use unsupervised k-means clustering \citep{kmeans} to discover different station types. \\ \\
In a subsequent step in chapter \ref{sec:results}, we assign one of the following labels to each cluster (cf. Fig. \todo{Figure Patterns, Indices}):
\begin{itemize}[noitemsep]
    \item \emph{Utilitarian}: Traffic showing strong commuting patterns, with two distinct peaks in traffic volume during the morning and afternoon hours.
    \item \emph{Recreational}: Traffic dominated by leisure activities. These locations exhibit a single peak in traffic volume around midday or early afternoon.
    \item \emph{Mixed}: Locations that serve a dual purpose, showing characteristics of both utilitarian and recreational usage.
\end{itemize}
% k-Means Features
To characterise the counting stations, we derive three distinct features that capture traffic patterns across different timescales: daily, weekly and seasonal
to exploit the distinct pattern visible in Figure xyz \todo{Figure pattern}.
% DPI
\subsection*{Double Peak Index (DPI)}\label{sec:dpi}
Weekday hourly profiles of some stations exhibit a double-peak structure, typically associated with morning and evening commuting.
The DPI quantifies this behaviour by identifying dominant morning (5–10 h) and evening (14–20 h) peaks and relating their magnitudes to the average midday level (8–14 h). 
Stations with clear, balanced commuting peaks yield high DPI values, whereas flat or single-peak profiles result in low scores. \\ \\ 
Formally, let $p_m$ and $p_e$ denote the magnitudes of the morning and evening peaks at hours $h_m$ and $h_e$, and let $m$ be the average midday traffic level. The DPI is defined as
\begin{align*}
    \text{DPI} &= \max\!\left( S \cdot Y \cdot D,\, 0 \right)
\end{align*}
where $S$, $Y$ and $D$ models strength, symmetry and distance, respectively:
\begin{align*}
        S &= \frac{(p_m - m) + (p_e - m)}{2} \\
    Y &= 1 - \frac{|p_m - p_e|}{\max(p_m, p_e)} \\
    D &= \min\!\left(\frac{|h_e - h_m|}{10},\, 1\right)
\end{align*}
\subsection*{Weekend Shape Difference (WSD)}\label{sec:wsd}
% WSD
Differences between weekday and weekend hourly traffic patterns provide an additional discriminator between usage types. To capture this effect, we compare the shape of the weekday and weekend hourly profiles.
Let $\mathbf{p}^{wd}$ and $\mathbf{p}^{we}$ denote the weekday and weekend hourly profiles, normalised to sum to one.
\begin{align*}
\text{WSD} =
\left\lVert
\frac{\mathbf{p}^{wd}}{\sum_h p^{wd}_h}
-
\frac{\mathbf{p}^{we}}{\sum_h p^{we}_h}
\right\rVert_2
\end{align*}
% SDI
\subsection*{Seasonal Drop Index (SDI)}\label{sec:sdi}
Finally, we consider long-term patterns. Seasonality provides a discriminator between leisure and utilitarian-oriented stations. The SDI quantifies the relative decline between high and low-usage months.
Let $I_m$ denote the monthly index values of a station. Using upper and lower quantiles to ensure robustness against outliers
\begin{align*}
q_{90} &= \text{quantile}_{0.9}(I_m) \\
q_{10} &= \text{quantile}_{0.1}(I_m)
\end{align*}
the SDI is defined as
\begin{align*}
\text{SDI} &= \frac{q_{90} - q_{10}}{q_{90}}
\end{align*}
High values indicate strong seasonal variation, whereas low values correspond to relatively stable, year-round usage.

\subsection*{Temporal Clustering}\label{sec:clustering}
To account for temporal variability in bicycle traffic, $k$-means clustering is performed on sliding two-year windows with monthly shifts. Feature vectors are recomputed separately for each window.

For each station $s$ and usage type $u$, the empirical cluster membership probability is defined as
\[
P(u \mid s) = \frac{1}{N_s} \sum_{i=1}^{N_s} \mathbb{I}\bigl( c_i(s) = u \bigr),
\]
where $c_i(s)$ denotes the cluster assignment in the $i$-th run and $N_s$ the number of valid runs.

Since $k$-means produces unlabeled partitions, cluster semantics are assigned post hoc by ordering clusters according to a centroid-level \emph{utilitarian score}
\[
\text{DPI} + \text{WSD} - \text{SDI},
\]
with lower scores labeled as \emph{recreational}, intermediate as \emph{mixed}, and higher as \emph{utilitarian}.

\subsection*{Weather and Event Class Definitions}
For the event-based analysis, days were grouped into three classes based on temperature and precipitation (Table~\ref{tab:weather_classes}).

Low-condition days ($L$) serve as baseline, and relative changes in mean daily bicycle counts for class $X \in \{M,H\}$ are computed as
\[
\Delta_X = \frac{\bar{C}_X - \bar{C}_L}{\bar{C}_L} \times 100,
\]

\begin{table}[h!]
\centering
\caption{Weather class definitions for the event-based analysis.}
\label{tab:weather_classes}
\small
\begin{tabular}{c cc}
\toprule
Class &
$T_{\max}$ [$^\circ$C] &
$P_{\text{day}}$ [mm] \\
\midrule
$L$ & $< 10$        & $= 0$ \\
$M$ & $[10,\,20)$   & $(0,\,5]$ \\
$H$ & $\ge 20$      & $> 5$ \\
\bottomrule
\end{tabular}
\end{table}


\section{Results}\label{sec:results}
This section presents the results of the proposed clustering approach and analyzes the spatial distribution of station usage types as well as their sensitivity to external factors.
\subsection{Station Usage Types and Spatial Structure}\label{sec:results_clustering}
Figure~\ref{fig:clustering_prob} presents the probabilistic usage-type assignments. 
Cluster labels correspond to the usage types defined in Section~\ref{sec:clustering} and are assigned based on the centroid-level utilitarian score.
Some stations show near-deterministic assignments with low entropy (e.g., S1–S3), while others exhibit more balanced probabilities, indicating temporally variable usage.

\begin{figure}[h!]
    \centering
    \caption{Probabilistic usage-type assignments of bicycle counting stations.}
    \includegraphics[width=\columnwidth]{img/clustering_prob.png}
    \label{fig:clustering_prob}
\end{figure}

In the following analysis, each station is assigned its dominant usage type, defined as the class with the highest assignment probability. 
Figure~\ref{fig:station_map} visualizes the spatial distribution of stations by dominant usage type.

\begin{figure}[h!]
    \centering
    \caption{
    Spatial distribution of bicycle counting stations in Heidelberg. 
    Marker color and shape indicate the dominant usage type. Marker size reflects the assignment probability of the dominant class.}
    \includegraphics[width=\columnwidth]{img/station_usage_map.png}
    \label{fig:station_map}
\end{figure}

Utilitarian stations are primarily located along major traffic corridors and key commuting links.
For example, Ernst-Walz-Bridge (S10) serves as Heidelberg’s central river crossing, while Gaisbergstraße (S4) is a designated bicycle priority corridor intended to relieve bicycle traffic from the parallel Rohrbachstraße (S7) \cite{adfc_heidelberg_fahrradstrassen}.


Mixed stations predominantly occur in transitional urban zones.
Stations such as S5, S6, and S9 connect several residential districts to the city center and combine utilitarian demand with recreational usage due to their location along the Neckar river.
Similarly, S13 is located along a corridor linking Kirchheim to the city center and bordering extensive green areas.


Recreational stations are mainly located in areas with limited commuting relevance and high leisure appeal. For example, Plöck (S1) lies in Heidelberg’s historic old town near the Universitätsbibliothek Heidelberg and other university buildings. 
This results in predominantly tourist- and student-oriented traffic with reduced utilitarian demand.


\subsection{Impact of External Factors on Usage Types}\label{sec:results_external}
We first examine the effects of weather conditions, followed by the impact of public holidays on station usage.

\begin{table}[h!]
\centering
\caption{Effect of temperature on station usage across usage types.}
\label{tab:temperature_effect}
\small
\begin{tabularx}{\linewidth}{l*{6}{c}}
\toprule
 & \multicolumn{3}{c}{\textbf{Weekdays}} 
 & \multicolumn{3}{c}{\textbf{Weekends}} \\
\textbf{Type}
 & $L$ & $\Delta_M$ & $\Delta_H$
 & $L$ & $\Delta_M$ & $\Delta_H$ \\
\midrule
Mix
& 1447 & 31\% & 72\%
& 948  & 49\% & 116\% \\

Rec
& 1034 & 17\% & 36\%
& 801  & 26\% & 59\% \\

Util
& 3543 & 18\% & 43\%
& 2525 & 26\% & 65\% \\
\bottomrule
\end{tabularx}
\end{table}

Table~\ref{tab:temperature_effect} shows that bicycle traffic increases with rising temperatures across all usage types.
The effect is most pronounced for mixed and recreational stations, particularly on weekends, where high-temperature days lead to increases exceeding 100\% relative to the low-temperature baseline.
In contrast, utilitarian stations exhibit more moderate temperature sensitivity, consistent with weather-resilient commuting behavior.




\begin{table}[h!]
\centering
\caption{Effect of precipitation on station usage across usage types.}
\label{tab:precipitation_effect}
\small
\begin{tabularx}{\linewidth}{l*{6}{c}}
\toprule
 & \multicolumn{3}{c}{\textbf{Weekdays}} 
 & \multicolumn{3}{c}{\textbf{Weekends}} \\
\textbf{Type}
 & $L$ & $\Delta_M$ & $\Delta_H$
 & $L$ & $\Delta_M$ & $\Delta_H$ \\
\midrule
Mix
& 2100 & $-17$\% & $-37$\%
& 1587 & $-19$\% & $-46$\% \\

Rec
& 1510 & $-9$\%  & $-22$\%
& 1275 & $-12$\% & $-29$\% \\

Util
& 4810 & $-8$\%  & $-23$\%
& 3823 & $-13$\% & $-29$\% \\
\bottomrule
\end{tabularx}
\end{table}

Precipitation has a consistently negative effect on bicycle traffic for all station types (Table~\ref{tab:precipitation_effect}).
Recreational and mixed stations show the strongest declines, particularly on weekends, whereas utilitarian stations are less affected.
This asymmetry suggests that discretionary trips are more readily suppressed by adverse weather conditions than commuting trips.


\begin{table}[h!]
\centering
\caption{Effect of public holidays on station usage by usage type.}
\label{tab:holiday_effect}
\small
\newcolumntype{C}{>{\centering\arraybackslash}X}
\begin{tabularx}{\linewidth}{l C C C}
\toprule
\textbf{Type}
& No holiday
& Holiday
& $\Delta$ \\
\midrule
Mix        & 1648 &  953 & $-28.6\%$ \\
Rec & 1260 &  728 & $-42.2\%$ \\
Util  & 3238 & 2043 & $-42.8\%$ \\
\bottomrule
\end{tabularx}
\end{table}
\todo{Maybe calc delta of different holidays}

Public holidays substantially reduce bicycle traffic across all usage types (Table~\ref{tab:holiday_effect}).
The strongest relative declines are observed for recreational and utilitarian stations, indicating a shift away from both leisure routines and regular commuting.
Mixed stations exhibit a comparatively smaller reduction, reflecting their dual functional role.
Overall, holiday effects resemble weekend-like demand patterns but with amplified reductions in total volume.



%\begin{itemize}
%    \item describe temporal shift, describe why this is expected and why, PLOT: city,
%    \item describe holidays impact, describe behaviour (similar as weekend) PLOT: show shift
%    \item include also plot of different public holidays (my own one), this is just to have a funny fact (Vater Tag) PLOT: funny plot, na werden zu viele plots
%    \item describe weather impact, obvious PLOT: weather
%\end{itemize}


\section{Conclusion}\label{sec:conclusion}
\begin{itemize}
    \item summarize
    \item limitations
    \item problems
    \item statements that can be made
\end{itemize}

\clearpage

% Footnote
%\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution
\printAffiliationsAndNotice{\icmlEqualContribution} % otherwise use the standard text.

\section*{Contribution Statement}
Add this, see original template

\bibliography{bibliography}
\bibliographystyle{icml2025}

\end{document}

% This document was modified from the files available at https://icml.cc/Conferences/2025/AuthorInstructions
% the full copyright notice is available within the file icml2025.sty